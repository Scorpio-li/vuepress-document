# DNS基础知识

## 1. DNS
- DNS（Domain Name System，域名系统），最初，由于ip长且难记，通过ip访问网站不方便。。所以后来通过发明了DNS服务器，这个时候我们访问网站输入网站域名，DNS服务器就解析我们的域名为ip。这样我们实际访问的就是对应的ip地址啦。

- 抽象点DNS就是 一个记录ip地址的超级分布式数据库。


## 2. 根域和根域服务器
- 当我们输入www.sunhao.win访问网站。实际上是访问了不同的域。
其中”.”是DNS 命称空间，用来分割不同域,

- www,sunhao,win分别代表不同的域。其实还有个域，跟在win后面，只是因为是域名系统默认的,所以这里不用写，这个就是根域。
<!-- more -->
```
<!--意义上域名应该是这样。-->
www.sunhao.win.根域
```
- 根域记录了所有win域(这一个位置的叫顶级域),它和sunhao(二级域),共同构成顶级域名sunhao.win, www(三级域)和sunhao.win叫二级域名www.sunhao.win

- 因为我们上网使用的UDP/TCP，UDP数据往往没有保障,但速度快,通常用于查询和响应，TCP由于多次验证，传输有保证，但速度慢，多用于主服务器和从服务器之间的传送。

- 因此我们DNS主要通过UDP。当我们访问www.sunhao.win的时候,如果本地dns服务器没有记录，那么它就会向根服务器去请求地址。

- 也就是它会向根服务器请求win域的地址。然后通过win域继续向下请求。根域名服务器并不直接把待查询的域名直接解析出IP地址，而是告诉本地域名服务器下一步应当找哪一个顶级域名服务器进行查询。所以根域名服务器很重要。假定所有的根域名服务器都瘫痪了，那么整个DNS系统就无法工作。



## 3. 顶级域和顶级域服务器
- 例如www.sunhao.win: win所在的位置就是顶级域

- 域名只是逻辑概念，并不代表计算机所在的物理地点。据2006年12月统计，现在顶级域名TLD(Top Level Domain)已有265个，分为三大类：

    1. (1)国家顶级域名nTLD：采用ISO3166的规定。如：cn代表中国，us代表美国，uk代表英国，等等。国家域名又常记为ccTLD(cc表示国家代码contry-code)。
    
    2. (2)通用顶级域名gTLD：最常见的通用顶级域名有7个，即：com(公司企业)，net(网络服务机构)，org(非营利组织)，int(国际组织)，gov(美国的政府部门)，mil(美国的军事部门)。
   
    3. (3)基础结构域名(infrastructure domain)：这种顶级域名只有一个，即arpa，用于反向域名解析，因此称为反向域名。

- 顶级域名服务器主要负责管理在该顶级域名服务器注册的二级域名


## 4. 权威DNS和权威域名服务器
- 权威DNS服务器是经过上一级授权，对域名进行解析的服务器，同时它可以把解析授权转授给其他人。

- 例如，
在互联网上,谁售出的域名,就把域名授权给谁，比如sunhao.win是阿里售出的，所以权威服务器是阿里的dns解析服务器。(为了保障安全一般权威DNS服务器都是俩)
dns9.hichina.com
dns10.hichina.com

但是由于业务我从后台调整解析到yunjiasu。


```
;; AUTHORITY SECTION:
sunhao.win.		2992	IN	NS	n563.ns.yunjiasu.com.
sunhao.win.		2992	IN	NS	n3101.ns.yunjiasu.com.
```


其中n563.ns.yunjiasu.com和n3101.ns.yunjiasu.com是sunhao.win的权威服务器。
由顶级域名win授权ns.yunjiasu.com.进行管理的。

当访问sunhao.win通过顶级域名解析后，顶级域名win就给用户说,你要访问sunhao.win是吧，你得去n563.ns.yunjiasu.com看看,它那记录了ip地址,不行就去n3101.ns.yunjiasu.com.再不行，你就自己报错把。^_^.

通俗点说,就是爸爸给孩子十块钱(这里指域名)，这十块钱,孩子可以自己花，也可以转给别人。拥有了控制十块钱的所有权限。简单点说,就是一旦把域名授权给我，授权给我的那部分，我做主。


## 5. 运营商DNS服务器和本地DNS服务器
- 在实际上网中，我们不是直接连接根服务器，而是通过本地DNS服务器上网。
如果DNS设置不好，或者不对，会导致如我们qq能登陆，而页面无法浏览网页的症状、
在这，本地DNS主要指是指各地电信运营商提供的域名解析服务器。也就是我们在上网网卡里面你设置的DNS地址。当然也可以自己建设一个服务器。
![image](http://ojlt0g866.bkt.clouddn.com/blog/20170512/134034145.png)

- 当一个主机发出DNS查询请求时，这个查询请求报文就发送给本地域名服务器，本地服务器替我们进行DNS解析,我们得到的ip地址是由本地服务器返回的。